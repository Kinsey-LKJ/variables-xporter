import { Callout } from 'nextra/components'

# Multi-mode variable management

Figma's multi-mode functionality provides the foundation for creating more powerful variable systems. We'll explore how to create complex multi-mode variable systems using the **single outlet principle**, which can include combinations of light/dark themes, brand themes, responsive design, and density modes.

## Traditional multi-mode variable organization

Let's first look at the traditional way of organizing multi-mode variables. Taking light/dark themes as an example, the conventional approach is to set different mode values for each variable within the same collection:

```
┌──────────────────────┬──────────┬──────────┐
│ Collection           │ light    │ dark     │
├──────────────────────┼──────────┼──────────┤
│ colors/primary       │ #E55517  │ #EE6D21  │
│ colors/background    │ #FFFFFF  │ #1F2937  │
│ colors/text          │ #111827  │ #F9FAFB  │
│ font/size/base       │ 16px     │ 16px     │
│ font/size/lg         │ 18px     │ 18px     │
│ font/size/xl         │ 20px     │ 20px     │
│ font/weight/normal   │ 400      │ 400      │
│ font/weight/medium   │ 500      │ 500      │
│ font/weight/bold     │ 700      │ 700      │
│ spacing/base         │ 16px     │ 16px     │
│ spacing/loose        │ 24px     │ 24px     │
│ spacing/tight        │ 8px      │ 8px      │
└──────────────────────┴──────────┴──────────┘
```

While this approach seems intuitive when dealing with just light/dark theme switching, it faces several challenges as the project grows:

1. **Strong coupling between variables and modes**
   - Each variable must have values set for all modes
   - Values must be repeated even for variables that remain constant across modes (like font sizes, weights, and spacing)

2. **Difficult to scale and maintain**
   - All mode variations are concentrated in one place, making variable management complex
   - When adding new mode dimensions (like brand themes), mode combinations grow exponentially

## Single outlet principle

**The single outlet principle states that in a variable system, all variables should have a single collection as their sole outlet, containing only one mode, and implement multi-mode variable management through references to variables in other collections.** Let's see how to elegantly organize light/dark theme variables using this principle, making our variable management clearer and more maintainable.

### Creating the Design Tokens collection (main collection)

First, we create a main collection to store all design variables:

```
┌────────────────────────┬────────────────────────┐
│                        │                        │
│ Design Tokens          │         default        │
│                        │                        │
├────────────────────────┼────────────────────────┤
│                        │                        │
│ colors/primary/DEFAULT │ #EE6D21                │
│ colors/zhiyun/600      │ #EE6D21                │
│ colors/zhiyun/500      │ #E55517                │
│ colors/fiveray/600     │ #DA5959                │
│ colors/fiveray/500     │ #C03939                │
│ ...                    │ ...                    │
│                        │                        │
└────────────────────────┴────────────────────────┘
```

This main collection contains only one default mode and serves as the unified outlet for all variables. So how do we implement light/dark theme switching? This is where a dedicated theme mode collection comes in.

### Creating the Theme Modes collection

Next, we create a collection specifically for managing theme modes:

```
┌────────────────────────┬──────────────────────┬─────────────────────┐
│                        │                      │                     │
│ Theme Modes            │         light        │         dark        │
│                        │                      │                     │
├────────────────────────┼──────────────────────┼─────────────────────┤
│                        │                      │                     │
│ colors/primary/DEFAULT │ colors/primary/light │ colors/primary/dark │
│                        │                      │                     │
└────────────────────────┴──────────────────────┴─────────────────────┘
```

This collection is dedicated to storing variables that need to switch between light and dark themes. **By having variables in the main collection reference their corresponding variables in this collection, we achieve elegant theme switching.**

### Variable reference chain

```
                ┌────────────────────────┬────────────────────────┐
                │                        │                        │
                │ Design Tokens          │         defalut        │
                │                        │                        │
                ├────────────────────────┼────────────────────────┤
                │                        │                        │
                │ colors/primary/DEFAULT │ colors/primary/DEFAULT |───────┐
                │                        │                        │       │
┌──────────────►│ colors/zhiyun/600      │ #E55517                │       │
│               │                        │                        │       │
├──────────────►│ colors/zhiyun/500      │ #C03939                │       │
│               │                        │                        │       │
│               │ ...                    │ ...                    │       │
│               │                        │                        │       │
│               └────────────────────────┴────────────────────────┘       │
│                                                                         │
│                                                                         │
│    ┌────────────────────────────────────────────────────────────────────┘
│    │
│    │
│    │           ┌────────────────────────┬──────────────────────┬─────────────────────┐
│    │           │                        │                      │                     │
│    │           │ Theme Modes            │         light        │         dark        │
│    │           │                        │                      │                     │
│    │           ├────────────────────────┼──────────────────────┼─────────────────────┤
│    │           │                        │                      │                     │
│    └──────────►│ colors/primary/DEFAULT │ colors/zhiyun/600──┐ │ colors/zhiyun/500─┐ │
│                │                        │                    │ │                   │ │
│                │ ...                    │ ...                │ │ ...               │ │
│                │                        │                    │ │                   │ │
│                └────────────────────────┴────────────────────┼─┴───────────────────┼─┘
│                                                              │                     │
│                                                              │                     │
└──────────────────────────────────────────────────────────────┴─────────────────────┘
```

Let's take `colors/primary/DEFAULT` as an example to explain this workflow in detail:

1. In the Design Tokens collection, this variable references the `colors/primary/DEFAULT` variable from the Theme Modes collection
2. In the Theme Modes collection, this variable has different values set for different modes, enabling theme switching
3. Importantly, the Theme Modes collection only needs to include variables that change across different theme modes; unchanging variables don't need to appear here

<Callout type="info" emoji="💡">
**Designer's perspective:** In Figma, designers only need to select variables from the Design Tokens collection, without worrying about the underlying variable reference relationships. This is the advantage of the single outlet principle — providing a unified, clear interface.

**Export process:** When using the Variables Xporter plugin, you only need to export variables from the Design Tokens collection. The plugin automatically traces each variable's reference chain to ensure it gets the final concrete values, without needing to export the Theme Modes collection.
</Callout>

## Creating complex multi-mode variable systems

Using the single outlet principle enables us to create complex multi-dimensional variable systems, such as those combining light/dark themes, brand themes, responsive design, and density modes. Let's build this step by step and experience the benefits of the single outlet principle.

### Starting with brand theme combinations

We currently have a variable system that supports light/dark themes. Now we want to add brand theme variables on top of that.

```
                ┌────────────────────────┬────────────────────────┐
                │                        │                        │
                │ Design Tokens          │         defalut        │
                │                        │                        │
                ├────────────────────────┼────────────────────────┤
                │                        │                        │
                │ colors/primary/DEFAULT │ colors/primary/DEFAULT │───────┐
                │                        │                        │       │
┌──────────────►│ colors/zhiyun/600      │ #E55517                │       │
│               │                        │                        │       │
├──────────────►│ colors/zhiyun/500      │ #C03939                │       │
│               │                        │                        │       │
│               │ ...                    │ ...                    │       │
│               │                        │                        │       │
│               └────────────────────────┴────────────────────────┘       │
│                                                                         │
│                                                                         │
│    ┌────────────────────────────────────────────────────────────────────┘
│    │
│    │
│    │           ┌────────────────────────┬──────────────────────┬─────────────────────┐
│    │           │                        │                      │                     │
│    │           │ Theme Modes            │         light        │         dark        │
│    │           │                        │                      │                     │
│    │           ├────────────────────────┼──────────────────────┼─────────────────────┤
│    │           │                        │                      │                     │
│    └──────────►│ colors/primary/DEFAULT │ colors/zhiyun/600──┐ │ colors/zhiyun/500─┐ │
│                │                        │                    │ │                   │ │
│                │ ...                    │ ...                │ │ ...               │ │
│                │                        │                    │ │                   │ │
│                └────────────────────────┴────────────────────┼─┴───────────────────┼─┘
│                                                              │                     │
│                                                              │                     │
└──────────────────────────────────────────────────────────────┴─────────────────────┘
```

### Adding brand theme modes

Create a Brands Modes collection to manage brand theme variables, with two different brand modes (in this example, `zhiyun` and `fiveray`). Create two variables `colors/primary/light` and `colors/primary/dark`, setting different values for each mode (in this example, referencing related colors from the main Design Tokens collection).

```
 ┌────────────────────────┬──────────────────────┬─────────────────────┐
 │                        │                      │                     │
 │ Brands Modes           │        zhiyun        │        fiveray      │
 │                        │                      │                     │
 ├────────────────────────┼──────────────────────┼─────────────────────┤
 │                        │                      │                     │
 │ colors/primary/light   │ colors/zhiyun/600    │ colors/fiveray/600  │
 │                        │                      │                     │
 │ colors/primary/dark    │ colors/zhiyun/600    │ colors/fiveray/50   │
 │                        │                      │                     │
 │ ...                    │ ...                  │ ...                 │
 │                        │                      │                     │
 └────────────────────────┴──────────────────────┴─────────────────────┘
```

Next, establish variable reference relationships: variables in the Theme Modes collection reference corresponding variables from the Brands Modes collection based on the current theme, while variables in the Brands Modes collection reference concrete color values from the Design Tokens collection. This way, when switching brands or themes, all system colors update accordingly.

```


                   ┌────────────────────────┬────────────────────────┐
                   │                        │                        │
                   │ Design Tokens          │         defalut        │
                   │                        │                        │
                   ├────────────────────────┼────────────────────────┤
                   │                        │                        │
                   │ colors/primary/DEFAULT │ colors/primary/DEFAULT │───────┐
                   │                        │                        │       │
   ┌──────────────►│ colors/zhiyun/600      │ #E55517                │       │
   │               │                        │                        │       │
   ├──────────────►│ colors/zhiyun/500      │ #C03939                │       │
   │               │                        │                        │       │
   ├──────────────►│ colors/fiveray/600     │ #EE6D21                │       │
   │               │                        │                        │       │
   ├──────────────►│ colors/fiveray/500     │ #DA5959                │       │
   │               │                        │                        │       │
   │               │ ...                    │ ...                    │       │
   │               │                        │                        │       │
   │               └────────────────────────┴────────────────────────┘       │
   │                                                                         │
   │                                                                         │
   │   ┌─────────────────────────────────────────────────────────────────────┘
   │   │
   │   │
   │   │           ┌────────────────────────┬──────────────────────┬─────────────────────┐
   │   │           │                        │                      │                     │
   │   │           │ Theme Modes            │         light        │         dark        │
   │   │           │                        │                      │                     │
   │   │           ├────────────────────────┼──────────────────────┼─────────────────────┤
   │   │           │                        │                      │                     │
   │   └──────────►│ colors/primary/DEFAULT │ colors/primary/light │ colors/primary/dark │
   │               │                        │                      │                     │
   │               │ ...                    │ ...      │           │ ...       │         │
   │               │                        │          │           │           │         │
   │               └────────────────────────┴──────────┼───────────┴───────────┼─────────┘
   │                                                   │                       │
   │                                                   │                       │
   │   ┌───────────────────────────────────────────────┴───────────────────────┘
   │   │
   │   │
   │   │           ┌────────────────────────┬──────────────────────┬─────────────────────┐
   │   │           │                        │                      │                     │
   │   │           │ Brands Modes           │        zhiyun        │        fiveray      │
   │   │           │                        │                      │                     │
   │   │           ├────────────────────────┼──────────────────────┼─────────────────────┤
   │   │           │                        │                      │                     │
   │   ├──────────►│ colors/primary/light   │ colors/zhiyun/600──┐ │ colors/fiveray/600─┐│
   │   │           │                        │                    │ │                    ││
   │   └──────────►│ colors/primary/dark    │ colors/zhiyun/600──┤ │ colors/fiveray/50──┤│
   │               │                        │                    │ │                    ││
   │               │ ...                    │ ...                │ │ ...                ││
   │               │                        │                    │ │                    ││
   │               └────────────────────────┴────────────────────┼─┴────────────────────┼┘
   │                                                             │                      │
   │                                                             │                      │
   └─────────────────────────────────────────────────────────────┴──────────────────────┘

```
That's it! You've created a multi-dimensional variable system incorporating light/dark themes and brand themes, made flexible and maintainable through the single outlet principle.
Looking at the overall variable reference chain might seem complex, but it's far clearer and more maintainable than managing all variables in a single collection. But we're not done yet; let's further expand this variable system.

### Responsive design modes

Typically, font size variables need to adjust based on different screen sizes. Taking the `font/hero/size` variable as an example, first create a `font/hero/size` variable in the Design Tokens collection, along with `font/size/2xl` and `font/size/3xl` variables.

```
    ┌────────────────────────┬────────────────────────┐
    │                        │                        │
    │ Design Tokens          │         defalut        │
    │                        │                        │
    ├────────────────────────┼────────────────────────┤
    │                        │                        │
    │ colors/primary/DEFAULT │ colors/primary/DEFAULT │
    │                        │                        │
    │ colors/zhiyun/600      │ #E55517                │
    │                        │                        │
    │ colors/zhiyun/500      │ #C03939                │
    │                        │                        │
    │ colors/fiveray/600     │ #EE6D21                │
    │                        │                        │
    │ colors/fiveray/500     │ #DA5959                │
    │                        │                        │
───►│ font/hero/size         │ font/size/2xl          │
    │                        │                        │
───►│ font/size/2xl          │ 24                     │
    │                        │                        │
───►│ font/size/3xl          │ 30                     │
    │                        │                        │
    │ ...                    │ ...                    │
    │                        │                        │
    └────────────────────────┴────────────────────────┘
```
Create a Device Modes collection to manage responsive design variables, create a `font/hero/size` variable, and set different values for different device sizes.

```

 ┌────────────────────────┬──────────────────────┬─────────────────────┐
 │                        │                      │                     │
 │ Device Modes           │        default       │    min-width:1024   │
 │                        │                      │                     │
 ├────────────────────────┼──────────────────────┼─────────────────────┤
 │                        │                      │                     │
 │ font/hero/size         │ font/size/2xl        │ font/size/3xl       │
 │                        │                      │                     │
 │ ...                    │ ...                  │ ...                 │
 │                        │                      │                     │
 └────────────────────────┴──────────────────────┴─────────────────────┘
```

Now, simply change the value of the `font/hero/size` variable in the Design Tokens collection to reference the `font/hero/size` variable from the Device Modes collection!

```

       ┌────────────────────────┬────────────────────────┐
       │                        │                        │
       │ Design Tokens          │         defalut        │
       │                        │                        │
       ├────────────────────────┼────────────────────────┤
       │                        │                        │
       │ colors/primary/DEFAULT │ colors/primary/DEFAULT │
       │                        │                        │
       │ colors/zhiyun/600      │ #E55517                │
       │                        │                        │
       │ colors/zhiyun/500      │ #C03939                │
       │                        │                        │
       │ colors/fiveray/600     │ #EE6D21                │
       │                        │                        │
       │ colors/fiveray/500     │ #DA5959                │
       │                        │                        │
       │ font/hero/size         │ font/size/2xl          ├─────┐
       │                        │                        │     │
┌─────►│ font/size/2xl          │ 24                     │     │
│      │                        │                        │     │
├─────►│ font/size/3xl          │ 30                     │     │
│      │                        │                        │     │
│      │ ...                    │ ...                    │     │
│      │                        │                        │     │
│      └────────────────────────┴────────────────────────┘     │
│                                                              │
│                                                              │
│  ┌───────────────────────────────────────────────────────────┘
│  │
│  │
│  │   ┌────────────────────────┬──────────────────────┬─────────────────────┐
│  │   │                        │                      │                     │
│  │   │ Device Modes           │        default       │    min-width:1024   │
│  │   │                        │                      │                     │
│  │   ├────────────────────────┼──────────────────────┼─────────────────────┤
│  │   │                        │                      │                     │
│  └──►│ font/hero/size         │ font/size/2xl──┐     │ font/size/3xl──┐    │
│      │                        │                │     │                │    │
│      │ ...                    │ ...            │     │ ...            │    │
│      │                        │                │     │                │    │
│      └────────────────────────┴────────────────┼─────┴────────────────┼────┘
│                                                │                      │
│                                                │                      │
└────────────────────────────────────────────────┴──────────────────────┘
```
We've omitted the Theme Modes collection since its content remains the same. This is another advantage of the single outlet principle - we only need to focus on variables that need to change in specific modes.

### Density modes

Some B2B backend projects might have a compact mode where various dimensions become smaller, such as font sizes, spacing, and container widths. Let's further expand our variable system to include density modes.

First, create a series of `spacing` variables in the Design Tokens collection to manage spacing and dimensions. For demonstration purposes, we've only created one variable, `spacing/1`. In a real project, you'd need to create more variables like `spacing/2`, `spacing/3`, `spacing/4`, etc. See [Spacing variable organization recommendations](/docs/organizing-your-variables/spacing).

```

    ┌────────────────────────┬────────────────────────┐
    │                        │                        │
    │ Design Tokens          │         defalut        │
    │                        │                        │
    ├────────────────────────┼────────────────────────┤
    │                        │                        │
    │ colors/primary/DEFAULT │ colors/primary/DEFAULT │
    │                        │                        │
    │ colors/zhiyun/600      │ #E55517                │
    │                        │                        │
    │ colors/zhiyun/500      │ #C03939                │
    │                        │                        │
    │ colors/fiveray/600     │ #EE6D21                │
    │                        │                        │
    │ colors/fiveray/500     │ #DA5959                │
    │                        │                        │
    │ font/hero/size         │ font/size/2xl          │
    │                        │                        │
    │ font/size/2xl          │ 24                     │
    │                        │                        │
    │ font/size/3xl          │ 30                     │
    │                        │                        │
    │ spacing/1              │ spacing/1              │
    │                        │                        │
    │ ...                    │ ...                    │
    │                        │                        │
    └────────────────────────┴────────────────────────┘
```
Create a Density Modes collection to manage layout density, and create `spacing/1`, `font/size/2xl`, and `font/size/3xl` variables, setting different values for different density levels.

```
┌────────────────────────┬──────────────────────┬─────────────────────┐
│                        │                      │                     │
│ Density Modes          │        default       │       compact       │
│                        │                      │                     │
├────────────────────────┼──────────────────────┼─────────────────────┤
│                        │                      │                     │
│ spacing/1              │ 4                    │ 3                   │
│                        │                      │                     │
│ font/size/2xl          │ 24                   │ 22                  │
│                        │                      │                     │
│ font/size/3xl          │ 30                   │ 26                  │
│                        │                      │                     │
│ ...                    │ ...                  │ ...                 │
│                        │                      │                     │
└────────────────────────┴──────────────────────┴─────────────────────┘
```
Change the values of `spacing/1`, `font/size/2xl`, and `font/size/3xl` variables in the Design Tokens collection to reference their corresponding variables from the Density Modes collection.

```
    ┌────────────────────────┬────────────────────────┐
    │                        │                        │
    │ Design Tokens          │         defalut        │
    │                        │                        │
    ├────────────────────────┼────────────────────────┤
    │                        │                        │
    │ colors/primary/DEFAULT │ colors/primary/DEFAULT │
    │                        │                        │
    │ colors/zhiyun/600      │ #E55517                │
    │                        │                        │
    │ colors/zhiyun/500      │ #C03939                │
    │                        │                        │
    │ colors/fiveray/600     │ #EE6D21                │
    │                        │                        │
    │ colors/fiveray/500     │ #DA5959                │
    │                        │                        │
    │ font/hero/size         │ font/size/2xl          │
    │                        │                        │
    │ font/size/2xl          │ 24                     ├──────┐
    │                        │                        │      │
    │ font/size/3xl          │ 30                     ├──────┤
    │                        │                        │      │
    │ spacing/1              │ spacing/1              ├──────┤
    │                        │                        │      │
    │ ...                    │ ...                    │      │
    │                        │                        │      │
    └────────────────────────┴────────────────────────┘      │
                                                             │
                                                             │
┌────────────────────────────────────────────────────────────┘
│
│
│   ┌────────────────────────┬──────────────────────┬─────────────────────┐
│   │                        │                      │                     │
│   │ Density Modes          │        default       │       compact       │
│   │                        │                      │                     │
│   ├────────────────────────┼──────────────────────┼─────────────────────┤
│   │                        │                      │                     │
├──►│ spacing/1              │ 4                    │ 3                   │
│   │                        │                      │                     │
├──►│ font/size/2xl          │ 24                   │ 22                  │
│   │                        │                      │                     │
└──►│ font/size/3xl          │ 30                   │ 26                  │
    │                        │                      │                     │
    │ ...                    │ ...                  │ ...                 │
    │                        │                      │                     │
    └────────────────────────┴──────────────────────┴─────────────────────┘
```
Congratulations! You've created a powerful composite variable system that's easy to extend. This is a great start, and all the effort is worth it. As a design system maintainer, your variables may be used countless times by other designers and serve as a bridge between design and development, while they don't need to worry about these reference relationships.
