# 单一出口原则

单一出口原则是 Variables Xporter 推荐的核心变量组织理念，专门用来解决大型设计系统中复杂的多模式变量管理问题。

## 什么是单一出口原则？

**单一出口原则是指在一个变量系统中，所有的变量以一个集合作为唯一出口，这个集合只包含一个模式，并通过引用其他集合中的变量来实现多模式变量管理。**

## 传统方式的问题

在传统的 Figma 变量管理中，设计师通常会将所有模式的变量都放在同一个集合中：

```
传统集合（所有变量强耦合到一个集合）
├── Light 模式                  ├── Dark 模式
├── colors/primary: #3B82F6    ├── colors/primary: #60A5FA
├── colors/secondary: #10B981  ├── colors/secondary: #F59E0B
├── spacing/sm: 8px            ├── spacing/sm: 8px（重复设置）
└── font/size/base: 16px       └── font/size/base: 16px（重复设置）
```

这种方式存在以下问题：

- **冗余设置**：许多变量在不同模式下值相同，但需要重复设置
- **管理复杂**：随着模式增加，集合变得庞大难以管理
- **使用困惑**：设计师需要在多个模式间切换才能找到合适的变量
- **扩展困难**：添加新的模式维度时，需要大量重复工作

## 单一出口原则的解决方案

单一出口原则通过分离关注点来解决这些问题：

```
Design Tokens（主集合 - 唯一出口）
├── colors/primary/DEFAULT → 引用 Theme Modes 集合
├── colors/secondary/DEFAULT → 引用 Theme Modes 集合  
├── spacing/sm: 8px（直接值，无需多模式）
└── font/size/base: 16px（直接值，无需多模式）

Theme Modes（辅助集合 - 仅存放变化的变量）
├── Light 模式                          ├── Dark 模式
├── colors/primary/DEFAULT: #3B82F6    ├── colors/primary/DEFAULT: #60A5FA
└── colors/secondary/DEFAULT: #10B981  └── colors/secondary/DEFAULT: #F59E0B
```

## 核心优势

- **统一接口**：设计师只需从主集合选择变量，无需切换多个集合
- **高效导出**：导出时只需选择主集合，插件自动追踪引用链
- **易于扩展**：添加新模式维度时不影响现有结构
- **避免冗余**：只有变化的变量才放在模式集合中
- **灵活组合**：支持复杂的多维度模式组合

## 实际应用示例

让我们通过具体的示例来展示如何应用单一出口原则。

### 基础明暗主题实现

#### 第一步：创建 Design Tokens 集合（主集合）

首先，我们创建一个主集合来存放所有设计变量：

```
┌────────────────────────┬────────────────────────┐
│                        │                        │
│ Design Tokens          │         default        │
│                        │                        │
├────────────────────────┼────────────────────────┤
│                        │                        │
│ colors/primary/DEFAULT │ #EE6D21                │
│ colors/zhiyun/600      │ #EE6D21                │
│ colors/zhiyun/500      │ #E55517                │
│ colors/fiveray/600     │ #DA5959                │
│ colors/fiveray/500     │ #C03939                │
│ ...                    │ ...                    │
│                        │                        │
└────────────────────────┴────────────────────────┘
```

这个主集合只包含一个默认模式，它是所有变量的统一出口。

#### 第二步：创建 Theme Modes 集合

接下来，我们创建一个专门用于管理主题模式的集合：

```
┌────────────────────────┬──────────────────────┬─────────────────────┐
│                        │                      │                     │
│ Theme Modes            │         light        │         dark        │
│                        │                      │                     │
├────────────────────────┼──────────────────────┼─────────────────────┤
│                        │                      │                     │
│ colors/primary/DEFAULT │ colors/primary/light │ colors/primary/dark │
│                        │                      │                     │
└────────────────────────┴──────────────────────┴─────────────────────┘
```

这个集合专门负责存放需要在明暗主题间切换的变量。

#### 第三步：建立引用关系

通过让主集合中的变量引用此集合中的对应变量，我们就能实现优雅的主题切换：

```
                ┌────────────────────────┬────────────────────────┐
                │                        │                        │
                │ Design Tokens          │         default        │
                │                        │                        │
                ├────────────────────────┼────────────────────────┤
                │                        │                        │
                │ colors/primary/DEFAULT │ colors/primary/DEFAULT |───────┐
                │                        │                        │       │
┌──────────────►│ colors/zhiyun/600      │ #E55517                │       │
│               │                        │                        │       │
├──────────────►│ colors/zhiyun/500      │ #C03939                │       │
│               │                        │                        │       │
│               │ ...                    │ ...                    │       │
│               │                        │                        │       │
│               └────────────────────────┴────────────────────────┘       │
│                                                                         │
│                                                                         │
│    ┌────────────────────────────────────────────────────────────────────┘
│    │
│    │
│    │           ┌────────────────────────┬──────────────────────┬─────────────────────┐
│    │           │                        │                      │                     │
│    │           │ Theme Modes            │         light        │         dark        │
│    │           │                        │                      │                     │
│    │           ├────────────────────────┼──────────────────────┼─────────────────────┤
│    │           │                        │                      │                     │
│    └──────────►│ colors/primary/DEFAULT │ colors/zhiyun/600──┐ │ colors/zhiyun/500─┐ │
│                │                        │                    │ │                   │ │
│                │ ...                    │ ...                │ │ ...               │ │
│                │                        │                    │ │                   │ │
│                └────────────────────────┴────────────────────┼─┴───────────────────┼─┘
│                                                              │                     │
│                                                              │                     │
└──────────────────────────────────────────────────────────────┴─────────────────────┘
```

### 复杂多维度系统实现

使用单一出口原则能够创建复杂多维度的变量系统，例如包含明暗主题、品牌主题、响应式设计以及紧凑性模式等复合模式的变量系统。

#### 品牌主题组合

在明暗主题的基础上，我们可以加入品牌主题的变量系统。创建一个 Brands Modes 集合，用于管理品牌主题的变量：

```
 ┌────────────────────────┬──────────────────────┬─────────────────────┐
 │                        │                      │                     │
 │ Brands Modes           │        zhiyun        │        fiveray      │
 │                        │                      │                     │
 ├────────────────────────┼──────────────────────┼─────────────────────┤
 │                        │                      │                     │
 │ colors/primary/light   │ colors/zhiyun/600    │ colors/fiveray/600  │
 │                        │                      │                     │
 │ colors/primary/dark    │ colors/zhiyun/600    │ colors/fiveray/500  │
 │                        │                      │                     │
 │ ...                    │ ...                  │ ...                 │
 │                        │                      │                     │
 └────────────────────────┴──────────────────────┴─────────────────────┘
```

建立变量引用关系：Theme Modes 集合中的变量根据当前主题引用 Brands Modes 集合中对应的变量。

#### 响应式设计模式

通常，字体尺寸变量会根据不同的屏幕尺寸进行调整。创建一个 Device Modes 集合，用于管理响应式设计的变量：

```
 ┌────────────────────────┬──────────────────────┬─────────────────────┐
 │                        │                      │                     │
 │ Device Modes           │        default       │    min-width:1024   │
 │                        │                      │                     │
 ├────────────────────────┼──────────────────────┼─────────────────────┤
 │                        │                      │                     │
 │ font/hero/size         │ font/size/2xl        │ font/size/3xl       │
 │                        │                      │                     │
 │ ...                    │ ...                  │ ...                 │
 │                        │                      │                     │
 └────────────────────────┴──────────────────────┴─────────────────────┘
```

#### 紧凑性模式

对于B端后台项目，可能会有紧凑性模式。创建一个 Density Modes 集合：

```
┌────────────────────────┬──────────────────────┬─────────────────────┐
│                        │                      │                     │
│ Density Modes          │        default       │       compact       │
│                        │                      │                     │
├────────────────────────┼──────────────────────┼─────────────────────┤
│                        │                      │                     │
│ spacing/1              │ 4                    │ 3                   │
│                        │                      │                     │
│ font/size/2xl          │ 24                   │ 22                  │
│                        │                      │                     │
│ font/size/3xl          │ 30                   │ 26                  │
│                        │                      │                     │
│ ...                    │ ...                  │ ...                 │
│                        │                      │                     │
└────────────────────────┴──────────────────────┴─────────────────────┘
```

### 使用者视角

#### 设计师使用

在 Figma 中，设计师只需从 Design Tokens 集合中选择所需的变量即可，无需关心背后的变量引用关系。这就是单一出口原则的优势——提供一个统一的、清晰的接口。

#### 导出过程

使用 Variables Xporter 插件时，只需导出 Design Tokens 集合的变量。插件会自动追踪每个变量的引用链，确保获取最终的具体值，无需选择其他模式集合导出。

## 适用场景

单一出口原则特别适合以下场景：

- **多模式设计系统**：包含明暗主题、品牌主题等多个模式维度
- **大型设计系统**：变量数量庞大，需要清晰的组织结构
- **团队协作**：多人协作时需要统一的变量使用入口
- **复杂产品**：支持多种设备、状态、品牌的产品

## 注意事项

- **引用层级控制**：避免过深的引用嵌套
- **命名规范**：保持一致的变量命名约定
- **文档记录**：为重要的引用关系添加说明
- **定期维护**：检查引用链的完整性和合理性

通过采用单一出口原则，您可以构建一个既强大又简单的变量系统，让复杂的多模式设计系统变得清晰易管理。 