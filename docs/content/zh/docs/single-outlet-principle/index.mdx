import { Cards } from 'nextra/components'
import { Columns3 } from 'lucide-react'

# 单一出口原则

单一出口原则是 Variables Xporter 推荐的核心变量组织理念，专为解决大型设计系统中复杂的多模式变量管理问题而设计。

## 什么是单一出口原则？

**单一出口原则指的是在一个变量系统中，所有变量都使用一个集合作为唯一的出口。这个集合仅包含一个模式，并通过引用其他集合中的变量来实现多模式变量管理。**

## 传统方法的问题

在传统的 Figma Variables 管理中，设计师通常将所有模式变量放在同一个集合中：

```
传统集合（所有变量紧密耦合在一个集合中）
├── 浅色模式                     ├── 深色模式
├── colors/primary: #3B82F6    ├── colors/primary: #60A5FA
├── colors/secondary: #10B981  ├── colors/secondary: #F59E0B
├── spacing/sm: 8px            ├── spacing/sm: 8px（重复设置）
└── font/size/base: 16px       └── font/size/base: 16px（重复设置）
```

这种方法存在以下问题：

- **冗余设置**：许多变量在不同模式下具有相同的值，但需要重复设置
- **管理复杂性**：随着模式的增加，集合变得庞大且难以管理
- **使用混乱**：设计师需要在多个模式之间切换以找到合适的变量
- **扩展困难**：添加新的模式维度需要大量重复工作

## 单一出口原则的解决方案

单一出口原则通过关注点分离解决了这些问题：

```
设计标记（主集合 - 唯一出口）
├── colors/primary/DEFAULT → 引用主题模式集合
├── colors/secondary/DEFAULT → 引用主题模式集合  
├── spacing/sm: 8px（直接值，无需多模式）
└── font/size/base: 16px（直接值，无需多模式）

主题模式（辅助集合 - 仅存储变化的变量）
├── 浅色模式                             ├── 深色模式
├── colors/primary/DEFAULT: #3B82F6    ├── colors/primary/DEFAULT: #60A5FA
└── colors/secondary/DEFAULT: #10B981  └── colors/secondary/DEFAULT: #F59E0B
```

## 核心优势

- **统一界面**：设计师只需从主集合中选择变量，无需切换
- **高效导出**：仅导出主集合，插件会自动跟踪引用链
- **易于扩展**：添加新的模式维度不会影响现有结构
- **避免冗余**：仅将变化的变量放入模式集合中
- **灵活组合**：支持复杂的多维模式组合

## 实际应用示例

让我们通过具体示例演示如何应用单一出口原则。

### 基础的明暗主题实现

#### 第一步：创建 Design Tokens 集合（主集合）

首先，我们创建一个主集合来存储所有设计变量：

```
┌────────────────────────┬────────────────────────┐
│                        │                        │
│ Design Tokens          │         default        │
│                        │                        │
├────────────────────────┼────────────────────────┤
│                        │                        │
│ colors/primary/DEFAULT │ #EE6D21                │
│ colors/zhiyun/600      │ #EE6D21                │
│ colors/zhiyun/500      │ #E55517                │
│ colors/fiveray/600     │ #DA5959                │
│ colors/fiveray/500     │ #C03939                │
│ ...                    │ ...                    │
│                        │                        │
└────────────────────────┴────────────────────────┘
```

这个主集合仅包含一个默认模式，并作为所有变量的统一出口。

#### 第二步：创建主题模式集合

接下来，我们创建一个专门用于管理主题模式的集合：

```
┌────────────────────────┬──────────────────────┬─────────────────────┐
│                        │                      │                     │
│ Theme Modes            │         light        │         dark        │
│                        │                      │                     │
├────────────────────────┼──────────────────────┼─────────────────────┤
│                        │                      │                     │
│ colors/primary/DEFAULT │ colors/primary/light │ colors/primary/dark │
│                        │                      │                     │
└────────────────────────┴──────────────────────┴─────────────────────┘
```

这个集合专门用于存储需要在明暗主题之间切换的变量。

#### 第三步：建立引用关系

通过让主集合中的变量引用此集合中的对应变量，我们可以实现优雅的主题切换：

```
                ┌────────────────────────┬────────────────────────┐
                │                        │                        │
                │ Design Tokens          │         default        │
                │                        │                        │
                ├────────────────────────┼────────────────────────┤
                │                        │                        │
                │ colors/primary/DEFAULT │ colors/primary/DEFAULT |───────┐
                │                        │                        │       │
┌──────────────►│ colors/zhiyun/600      │ #E55517                │       │
│               │                        │                        │       │
├──────────────►│ colors/zhiyun/500      │ #C03939                │       │
│               │                        │                        │       │
│               │ ...                    │ ...                    │       │
│               │                        │                        │       │
│               └────────────────────────┴────────────────────────┘       │
│                                                                         │
│                                                                         │
│    ┌────────────────────────────────────────────────────────────────────┘
│    │
│    │
│    │           ┌────────────────────────┬──────────────────────┬─────────────────────┐
│    │           │                        │                      │                     │
│    │           │ Theme Modes            │         light        │         dark        │
│    │           │                        │                      │                     │
│    │           ├────────────────────────┼──────────────────────┼─────────────────────┤
│    │           │                        │                      │                     │
│    └──────────►│ colors/primary/DEFAULT │ colors/zhiyun/600──┐ │ colors/zhiyun/500─┐ │
│                │                        │                    │ │                   │ │
│                │ ...                    │ ...                │ │ ...               │ │
│                │                        │                    │ │                   │ │
│                └────────────────────────┴────────────────────┼─┴───────────────────┼─┘
│                                                              │                     │
│                                                              │                     │
└──────────────────────────────────────────────────────────────┴─────────────────────┘
```

### 用户视角

#### 设计师使用

在 Figma 中，设计师只需从 Design Tokens 集合中选择变量，而无需担心底层变量引用关系。这就是单一出口原则的优势——提供一个统一、清晰的界面。

#### 导出流程

使用 Variables Xporter 插件时，只需从 Design Tokens 集合中导出变量。插件会自动追踪每个变量的引用链，确保获取最终的具体值，而无需导出其他模式集合。


### 创建多维度的变量系统
使用单一出口原则可以创建更加复杂的多维变量系统，例如结合了明/暗主题、品牌主题、响应式设计和密度模式的系统。
<Cards>
  <Cards.Card
    icon={<Columns3 />}
    title="复杂的多维系统实现"
    href="/docs/organizing-your-variables/multi-mode"
    className="mt-4"
  />
</Cards>

## 适用场景

单一出口原则特别适用于：

- **多模式设计系统**：包括明暗主题、品牌主题及其他模式维度
- **大型设计系统**：拥有大量变量且需要清晰的组织结构
- **复杂产品**：支持多设备、多状态和多品牌

## 重要注意事项

- **引用层级控制**：避免过深的引用嵌套
- **命名规范**：保持一致的变量命名标准
- **文档记录**：为重要的引用关系添加描述
- **定期维护**：检查引用链的完整性和合理性


通过采用单一出口原则，您可以构建一个既强大又简单的变量系统，使复杂的多模式设计系统变得清晰且易于管理。