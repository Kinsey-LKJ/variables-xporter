import { Callout } from 'nextra/components'

# Multi-mode Variable Management

Figma's multi-mode functionality provides the foundation for creating more powerful variable systems. We'll introduce how to create complex multi-mode variable systems through the **Single Outlet Principle**, such as systems that simultaneously include dark/light themes, brand themes, responsive design, and density modes.

## Traditional Multi-mode Variable Organization

Let's first look at the traditional way of organizing multi-mode variables. Taking dark/light themes as an example, the traditional approach is to set different mode values for each variable within the same collection:

```
┌──────────────────────┬──────────┬──────────┐
│ Collection           │ light    │ dark     │
├──────────────────────┼──────────┼──────────┤
│ colors/primary       │ #E55517  │ #EE6D21  │
│ colors/background    │ #FFFFFF  │ #1F2937  │
│ colors/text          │ #111827  │ #F9FAFB  │
│ font/size/base       │ 16px     │ 16px     │
│ font/size/lg         │ 18px     │ 18px     │
│ font/size/xl         │ 20px     │ 20px     │
│ font/weight/normal   │ 400      │ 400      │
│ font/weight/medium   │ 500      │ 500      │
│ font/weight/bold     │ 700      │ 700      │
│ spacing/base         │ 16px     │ 16px     │
│ spacing/loose        │ 24px     │ 24px     │
│ spacing/tight        │ 8px      │ 8px      │
└──────────────────────┴──────────┴──────────┘
```

This approach seems intuitive when dealing with just dark/light theme switching, but it faces the following challenges as the project grows:

1. **Strong Coupling Between Variables and Modes**
   - Each variable must have values set for all modes
   - Even variables that remain constant across different modes (like font sizes, weights, and spacing) need to be repeated

2. **Difficult to Scale and Maintain**
   - All mode variations are concentrated in one place, making variable management complex
   - When adding new mode dimensions (like brand themes), mode combinations grow exponentially

## Single Outlet Principle

**The Single Outlet Principle means that in a variable system, all variables use one collection as the sole outlet, this collection contains only one mode, and implements multi-mode variable management by referencing variables from other collections.** Let's see how to use the Single Outlet Principle to elegantly organize dark/light theme variables, and how this method can help us create a more complex variable system.

### Creating Design Tokens Collection (Main Collection)

First, we create a main collection to store all design variables:

```
┌────────────────────────┬────────────────────────┐
│                        │                        │
│ Design Tokens          │         default        │
│                        │                        │
├────────────────────────┼────────────────────────┤
│                        │                        │
│ colors/primary/DEFAULT │ #EE6D21                │
│ colors/zhiyun/600      │ #EE6D21                │
│ colors/zhiyun/500      │ #E55517                │
│ colors/fiveray/600     │ #DA5959                │
│ colors/fiveray/500     │ #C03939                │
│ ...                    │ ...                    │
│                        │                        │
└────────────────────────┴────────────────────────┘
```

This main collection only contains one default mode, serving as the unified outlet for all variables. So how do we achieve dark/light theme switching? This is where we need another dedicated theme mode collection.

### Creating Theme Modes Collection

Next, we create a collection specifically for managing theme modes:

```
┌────────────────────────┬──────────────────────┬─────────────────────┐
│                        │                      │                     │
│ Theme Modes            │         light        │         dark        │
│                        │                      │                     │
├────────────────────────┼──────────────────────┼─────────────────────┤
│                        │                      │                     │
│ colors/primary/DEFAULT │ colors/primary/light │ colors/primary/dark │
│                        │                      │                     │
└────────────────────────┴──────────────────────┴─────────────────────┘
```

This collection is specifically responsible for storing variables that need to switch between light and dark themes. **By having the variables in the main collection reference the corresponding variables in this collection, we can achieve elegant theme switching.**

### Variable Reference Chain

```
                ┌────────────────────────┬────────────────────────┐
                │                        │                        │
                │ Design Tokens          │         defalut        │
                │                        │                        │
                ├────────────────────────┼────────────────────────┤
                │                        │                        │
                │ colors/primary/DEFAULT │ colors/primary/DEFAULT |───────┐
                │                        │                        │       │
┌──────────────►│ colors/zhiyun/600      │ #E55517                │       │
│               │                        │                        │       │
├──────────────►│ colors/zhiyun/500      │ #C03939                │       │
│               │                        │                        │       │
│               │ ...                    │ ...                    │       │
│               │                        │                        │       │
│               └────────────────────────┴────────────────────────┘       │
│                                                                         │
│                                                                         │
│    ┌────────────────────────────────────────────────────────────────────┘
│    │
│    │
│    │           ┌────────────────────────┬──────────────────────┬─────────────────────┐
│    │           │                        │                      │                     │
│    │           │ Theme Modes            │         light        │         dark        │
│    │           │                        │                      │                     │
│    │           ├────────────────────────┼──────────────────────┼─────────────────────┤
│    │           │                        │                      │                     │
│    └──────────►│ colors/primary/DEFAULT │ colors/zhiyun/600──┐ │ colors/zhiyun/500─┐ │
│                │                        │                    │ │                   │ │
│                │ ...                    │ ...                │ │ ...               │ │
│                │                        │                    │ │                   │ │
│                └────────────────────────┴────────────────────┼─┴───────────────────┼─┘
│                                                              │                     │
│                                                              │                     │
└──────────────────────────────────────────────────────────────┴─────────────────────┘
```

Let's take `colors/primary/DEFAULT` as an example to explain this workflow in detail:

1. In the Design Tokens collection, this variable references the variable named `colors/primary/DEFAULT` in the Theme Modes collection
2. In the Theme Modes collection, this variable is set to different values under different modes, thus achieving theme switching
3. Importantly, the Theme Modes collection only needs to contain variables that need to change across different Theme modes; other variables that remain constant don't need to appear here

<Callout type="info" emoji="💡">
**Designer's Perspective:** In Figma, designers only need to select variables from the Design Tokens collection, without worrying about the variable reference relationships behind the scenes. This is the advantage of the Single Outlet Principle — providing a unified, clear interface.

**Export Process:** When using the Variables Xporter plugin, you only need to export variables from the Design Tokens collection. The plugin will automatically trace each variable's reference chain, ensuring it gets the final concrete values. There's no need to select the Theme Modes collection for export.
</Callout>

## Creating Complex Multi-mode Variable Systems

Using the Single Outlet Principle allows you to create complex multi-dimensional variable systems, such as systems that include dark/light themes, brand themes, responsive design, and density modes. Let's build step by step and appreciate the benefits that the Single Outlet Principle brings.

### Starting with Brand Theme Combination

We currently have a variable system that supports dark/light themes, now we want to add brand theme variables to this system on top of the dark/light themes.

```
                ┌────────────────────────┬────────────────────────┐
                │                        │                        │
                │ Design Tokens          │         defalut        │
                │                        │                        │
                ├────────────────────────┼────────────────────────┤
                │                        │                        │
                │ colors/primary/DEFAULT │ colors/primary/DEFAULT │───────┐
                │                        │                        │       │
┌──────────────►│ colors/zhiyun/600      │ #E55517                │       │
│               │                        │                        │       │
├──────────────►│ colors/zhiyun/500      │ #C03939                │       │
│               │                        │                        │       │
├──────────────►│ colors/fiveray/600     │ #EE6D21                │       │
│               │                        │                        │       │
├──────────────►│ colors/fiveray/500     │ #DA5959                │       │
│               │                        │                        │       │
│               │ ...                    │ ...                    │       │
│               │                        │                        │       │
│               └────────────────────────┴────────────────────────┘       │
│                                                                         │
│                                                                         │
│    ┌────────────────────────────────────────────────────────────────────┘
│    │
│    │
│    │           ┌────────────────────────┬──────────────────────┬─────────────────────┐
│    │           │                        │                      │                     │
│    │           │ Theme Modes            │         light        │         dark        │
│    │           │                        │                      │                     │
│    │           ├────────────────────────┼──────────────────────┼─────────────────────┤
│    │           │                        │                      │                     │
│    └──────────►│ colors/primary/DEFAULT │ colors/primary/light │ colors/primary/dark │
│                │                        │                      │                     │
│                │ ...                    │ ...      │           │ ...       │         │
│                │                        │          │           │           │         │
│                └────────────────────────┴──────────┼───────────┴───────────┼─────────┘
│                                                    │                       │
│                                                    │                       │
│    ┌───────────────────────────────────────────────┴───────────────────────┘
│    │
│    │
│    │           ┌────────────────────────┬──────────────────────┬─────────────────────┐
│    │           │                        │                      │                     │
│    │           │ Brands Modes           │        zhiyun        │        fiveray      │
│    │           │                        │                      │                     │
│    │           ├────────────────────────┼──────────────────────┼─────────────────────┤
│    │           │                        │                      │                     │
│    ├──────────►│ colors/primary/light   │ colors/zhiyun/600──┐ │ colors/fiveray/600─┐│
│    │           │                        │                    │ │                    ││
│    └──────────►│ colors/primary/dark    │ colors/zhiyun/600──┤ │ colors/fiveray/50──┤│
│                │                        │                    │ │                    ││
│                │ ...                    │ ...                │ │ ...                ││
│                │                        │                    │ │                    ││
│                └────────────────────────┴────────────────────┼─┴────────────────────┼┘
│                                                             │                      │
│                                                             │                      │
└──────────────────────────────────────────────────────────────┴──────────────────────┘
```

### Adding Responsive Design Mode
Usually, font size variables need to adjust according to different screen sizes. Taking the `font/hero/size` variable as an example, first create a `font/hero/size` variable in the Design Tokens collection, and create `font/size/2xl` and `font/size/3xl` variables.

```
    ┌────────────────────────┬────────────────────────┐
    │                        │                        │
    │ Design Tokens          │         defalut        │
    │                        │                        │
    ├────────────────────────┼────────────────────────┤
    │                        │                        │
    │ colors/primary/DEFAULT │ colors/primary/DEFAULT │
    │                        │                        │
    │ colors/zhiyun/600      │ #E55517                │
    │                        │                        │
    │ colors/zhiyun/500      │ #C03939                │
    │                        │                        │
    │ colors/fiveray/600     │ #EE6D21                │
    │                        │                        │
    │ colors/fiveray/500     │ #DA5959                │
    │                        │                        │
───►│ font/hero/size         │ font/size/2xl          │
    │                        │                        │
───►│ font/size/2xl          │ 24                     │
    │                        │                        │
───►│ font/size/3xl          │ 30                     │
    │                        │                        │
    │ ...                    │ ...                    │
    │                        │                        │
    └────────────────────────┴────────────────────────┘
```
Create a Device Modes collection for managing responsive design variables, and create a `font/hero/size` variable, then set different values for different device sizes.
```
┌────────────────────────┬──────────────────────┬─────────────────────┐
│                        │                      │                     │
│ Device Modes           │        default       │    min-width:1024   │
│                        │                      │                     │
├────────────────────────┼──────────────────────┼─────────────────────┤
│                        │                      │                     │
│ font/hero/size         │ font/size/2xl        │ font/size/3xl       │
│                        │                      │                     │
│ ...                    │ ...                  │ ...                 │
│                        │                      │                     │
└────────────────────────┴──────────────────────┴─────────────────────┘
```

Now, just change the value of the `font/hero/size` variable in the Design Tokens collection to reference the `font/hero/size` variable from the Device Modes collection!
```
       ┌────────────────────────┬────────────────────────┐
       │                        │                        │
       │ Design Tokens          │         defalut        │
       │                        │                        │
       ├────────────────────────┼────────────────────────┤
       │                        │                        │
       │ colors/primary/DEFAULT │ colors/primary/DEFAULT │
       │                        │                        │
       │ colors/zhiyun/600      │ #E55517                │
       │                        │                        │
       │ colors/zhiyun/500      │ #C03939                │
       │                        │                        │
       │ colors/fiveray/600     │ #EE6D21                │
       │                        │
       │ colors/fiveray/500     │ #DA5959                │
       │                        │                        │
       │ font/hero/size         │ font/size/2xl          ├─────┐
       │                        │                        │     │
┌─────►│ font/size/2xl          │ 24                     │     │
│      │                        │                        │     │
├─────►│ font/size/3xl          │ 30                     │     │
│      │                        │                        │     │
│      │ ...                    │ ...                    │     │
│      │                        │                        │     │
│      └────────────────────────┴────────────────────────┘     │
│                                                              │
│                                                              │
│  ┌───────────────────────────────────────────────────────────┘
│  │
│  │
│  │   ┌────────────────────────┬──────────────────────┬─────────────────────┐
│  │   │                        │                      │                     │
│  │   │ Device Modes           │        default       │    min-width:1024   │
│  │   │                        │                      │                     │
│  │   ├────────────────────────┼──────────────────────┼─────────────────────┤
│  │   │                        │                      │                     │
│  └──►│ font/hero/size         │ font/size/2xl──┐     │ font/size/3xl──┐    │
│      │                        │                │     │                │    │
│      │ ...                    │ ...            │     │ ...            │    │
│      │                        │                │     │                │    │
│      └────────────────────────┴────────────────┼─────┴────────────────┼────┘
│                                                │                      │
│                                                │                      │
└────────────────────────────────────────────────┴──────────────────────┘
```
We skipped the Theme Modes collection because its content remains the same as before. This is another advantage of the Single Outlet Principle - we only need to focus on variables that need to change in specific modes.

### Adding Density Mode
Some B2B backend projects might have a density mode, where various dimensions might become smaller in this mode, such as font sizes, spacing, container widths, etc. Let's further expand our variable system to include density mode.
First, create a series of `spacing` variables in the Design Tokens collection to manage spacing and dimensions. For demonstration purposes, we've only created one variable, `spacing/1`; in actual projects, you'll need to create more variables like `spacing/2`, `spacing/3`, `spacing/4`, etc. See [Spacing Variable Organization Recommendations](/docs/organizing-your-variables/spacing).
```
    ┌────────────────────────┬────────────────────────┐
    │                        │                        │
    │ Design Tokens          │         defalut        │
    │                        │                        │
    ├────────────────────────┼────────────────────────┤
    │                        │                        │
    │ colors/primary/DEFAULT │ colors/primary/DEFAULT │
    │                        │                        │
    │ colors/zhiyun/600      │ #E55517                │
    │                        │                        │
    │ colors/zhiyun/500      │ #C03939                │
    │                        │                        │
    │ colors/fiveray/600     │ #EE6D21                │
    │                        │                        │
    │ colors/fiveray/500     │ #DA5959                │
    │                        │                        │
    │ font/hero/size         │ font/size/2xl          │
    │                        │                        │
    │ font/size/2xl          │ 24                     │
    │                        │                        │
    │ font/size/3xl          │ 30                     │
    │                        │                        │
    │ spacing/1              │ spacing/1              │
    │                        │                        │
    │ ...                    │ ...                    │
    │                        │                        │
    └────────────────────────┴────────────────────────┘
```
Create a Density Modes collection for managing layout density, and create `spacing/1`, `font/size/2xl`, and `font/size/3xl` variables, then set different values for different density levels.
```
┌────────────────────────┬──────────────────────┬─────────────────────┐
│                        │                      │                     │
│ Density Modes          │        default       │       compact       │
│                        │                      │                     │
├────────────────────────┼──────────────────────┼─────────────────────┤
│                        │                      │                     │
│ spacing/1              │ 4                    │ 3                   │
│                        │                      │                     │
│ font/size/2xl          │ 24                   │ 22                  │
│                        │                      │                     │
│ font/size/3xl          │ 30                   │ 26                  │
│                        │                      │                     │
│ ...                    │ ...                  │ ...                 │
│                        │                      │                     │
└────────────────────────┴──────────────────────┴─────────────────────┘
```
Change the values of `spacing/1`, `font/size/2xl`, and `font/size/3xl` variables in the Design Tokens collection to reference the corresponding variables from the Density Modes collection.
```
    ┌────────────────────────┬────────────────────────┐
    │                        │                        │
    │ Design Tokens          │         defalut        │
    │                        │                        │
    ├────────────────────────┼────────────────────────┤
    │                        │                        │
    │ colors/primary/DEFAULT │ colors/primary/DEFAULT │
    │                        │                        │
    │ colors/zhiyun/600      │ #E55517                │
    │                        │                        │
    │ colors/zhiyun/500      │ #C03939                │
    │                        │                        │
    │ colors/fiveray/600     │ #EE6D21                │
    │                        │                        │
    │ colors/fiveray/500     │ #DA5959                │
    │                        │                        │
    │ font/hero/size         │ font/size/2xl          │
    │                        │                        │
    │ font/size/2xl          │ 24                     ├──────┐
    │                        │                        │      │
    │ font/size/3xl          │ 30                     ├──────┤
    │                        │                        │      │
    │ spacing/1              │ spacing/1              ├──────┤
    │                        │                        │      │
    │ ...                    │ ...                    │      │
    │                        │                        │      │
    └────────────────────────┴────────────────────────┘      │
                                                             │
                                                             │
┌────────────────────────────────────────────────────────────┘
│
│
│   ┌────────────────────────┬──────────────────────┬─────────────────────┐
│   │                        │                      │                     │
│   │ Density Modes          │        default       │       compact       │
│   │                        │                      │                     │
│   ├────────────────────────┼──────────────────────┼─────────────────────┤
│   │                        │                      │                     │
├──►│ spacing/1              │ 4                    │ 3                   │
│   │                        │                      │                     │
├──►│ font/size/2xl          │ 24                   │ 22                  │
│   │                        │                      │                     │
└──►│ font/size/3xl          │ 30                   │ 26                  │
    │                        │                      │                     │
    │ ...                    │ ...                  │ ...                 │
    │                        │                      │                     │
    └────────────────────────┴──────────────────────┴─────────────────────┘
```
Congratulations! You've created a very powerful compound variable system that's also easy to extend. This is a good start, and all the effort is worth it. As a designer maintaining the design system, your variables might be used countless times by other designers and serve as a bridge between design and development, while they don't need to worry about these reference relationships.
